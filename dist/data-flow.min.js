"use strict";
/** DataFlow JS v1.0.8 by Aleksandar Panic. License: MIT **/!function(e,t){var h={isObject:function(t){return"object"==typeof t},isString:function(t){return"string"==typeof t},isUndefined:function(t){return void 0===t},isFunction:function(t){return"function"==typeof t}};function n(){}function r(t){this.element=h.isString(t.to)?e.querySelectorAll(t.to):t.to,this.multiple=t.multiple||1<this.element.length,this.renderer=t.renderer,!this.multiple&&this.element.length&&(this.element=this.element[0]),this.dataSource=t.dataSource,this.path=t.path,this.as=t.as||"text",this._bound=!0,this._boundHandler=this.update.bind(this),this.dataSource.bindHandler(this._boundHandler),this.changeDetector=t.changeDetector||null,this.onBind=t.onBind||n,this.onUpdate=t.onUpdate||n,this.onUnbind=t.onUnbind||n,this.onAfterRender=t.onAfterRender||n,this.changeDetector=t.changeDetector,this.onBind.call(this.element,this),this.updateDisabled=t.updateDisabled||!1,this.update()}function i(t,e,n){return Array.isArray(n)?function(t,e,n){for(var r=[],i=0;i<n.length;i++)r.push(o(t,e,n[i]));return r}(t,e,n):o(t,e,n)}function o(t,e,n){return n.dataSource||(n.dataSource=e),n.renderer||(n.renderer=t),new r(n)}function s(t,e,n){if(!e)return{result:t,path:null};if(e in t)return{result:t,path:e};for(var r=e.split("."),i=t,o=0;o<r.length-1;o++){var s=r[o];if(!(s in i)){if(!n)return{result:i,path:null};i[s]={}}if(o<r.length-1&&!h.isObject(i[s])){var a=r.slice(0,o+1).join(".");throw new Error("Cannot traverse data in path "+a+" since part of it is not an object.")}i=i[s]}return{result:i,path:r[r.length-1]}}function a(t){this._data=t||{},this._bound=!0,this.handlers=[]}r.prototype.getValue=function(t){return this.dataSource.get(this.path,t)},r.prototype.setValue=function(t){if(!this._bound)throw new Error("Cannot call setValue of unbound instance.");this.dataSource.set(this.path,t)},r.prototype.run=function(t){t.call(this,this.getValue()),this.dataSource.update()},r.prototype.shouldUpdate=function(t){return this.changeDetector?this.changeDetector(this.path,this.dataSource,this):!t||!this.path||t===this.path},r.prototype.update=function(t){if(this.updateDisabled)return;this.shouldUpdate(t)&&(this.onUpdate.call(this.element,this.getValue(),this),this.renderer.render(this))},r.prototype.unbind=function(){this._bound=!1,this.dataSource.unbindHandler(this._boundHandler),this.onUnbind.call(this.element,this)},a.prototype.set=function(t,e){if(!this._bound)throw new Error("Cannot call setValue of unbound instance.");var n=s(this._data,t,!0);h.isFunction(e)?e(n.result[n.path],this._data):n.result[n.path]=e;this.update(t)},a.prototype.get=function(t,e){var n=s(this._data,t);if(n.path)return n.result.hasOwnProperty(n.path)?n.result[n.path]:e;return e},a.prototype.run=function(t){t.call(this,this._data),this.update()},a.prototype.update=function(t){for(var e=0;e<this.handlers.length;e++)this.handlers[e].call(this,t)},a.prototype.unbind=function(){this.handlers=[],this._bound=!1},a.prototype.bindHandler=function(t){-1===this.handlers.indexOf(t)&&this.handlers.push(t)},a.prototype.unbindHandler=function(t){-1!==this.handlers.indexOf(t)&&this.handlers.splice(this.handlers.indexOf(t),1)};var u={};function d(){this.renderers={},function(t){var e={html:function(t,e){e.innerHTML=String(t.getValue())},text:function(t,e){e.textContent=String(t.getValue())}};for(var n in e)t.set(n,e[n]);for(var n in u)u.hasOwnProperty(n)&&t.set(n,u[n])}(this)}function l(t,e){if(e.multiple)for(var n=0;n<e.element.length;n++)t(e,e.element[n]);else t(e,e.element);e.onAfterRender.call(e.element,e)}function c(t,e){return e=e instanceof d?e:new d,(t=t instanceof a?t:new a(t)).bind=i.bind(t,e,t),t.renderer=e,t}d.prototype.render=function(t){var e=t.as;if("function"==typeof e)return void l(e,t);if(!(e in this.renderers))throw new Error("Unknown renderer: "+e);this.renderers[e](t)},d.prototype.set=function(t,e){this.renderers[t]=l.bind(this,e)},d.prototype.runOnBoundElement=l,d.setStaticRenderer=function(t,e){u[t]=e},c.bind=i,c.BoundElement=r,c.DataSource=a,c.Renderer=d,t.DataFlow=c}(document,window);
